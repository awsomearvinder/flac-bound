<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `FLAC__stream_encoder_set_metadata` fn in crate `flac_sys`."><meta name="keywords" content="rust, rustlang, rust-lang, FLAC__stream_encoder_set_metadata"><title>flac_sys::FLAC__stream_encoder_set_metadata - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../dark.css"><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script src="../storage.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="shortcut icon" href="../favicon.ico"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc fn"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../flac_sys/index.html'><div class='logo-container'><img src='../rust-logo.png' alt='logo'></div></a><div class="sidebar-elems"><p class='location'><a href='index.html'>flac_sys</a></p><script>window.sidebarCurrent = {name: 'FLAC__stream_encoder_set_metadata', ty: 'fn', relpath: ''};</script><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../src/flac_sys/lib.rs.html#7088-7092' title='goto source code'>[src]</a></span><span class='in-band'>Function <a href='index.html'>flac_sys</a>::<wbr><a class="fn" href=''>FLAC__stream_encoder_set_metadata</a></span></h1><pre class='rust fn'>pub unsafe extern &quot;C&quot; fn FLAC__stream_encoder_set_metadata(<br>&nbsp;&nbsp;&nbsp;&nbsp;encoder: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="struct" href="../flac_sys/struct.FLAC__StreamEncoder.html" title="struct flac_sys::FLAC__StreamEncoder">FLAC__StreamEncoder</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;metadata: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="struct" href="../flac_sys/struct.FLAC__StreamMetadata.html" title="struct flac_sys::FLAC__StreamMetadata">FLAC__StreamMetadata</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;num_blocks: <a class="type" href="https://doc.rust-lang.org/nightly/std/os/raw/type.c_uint.html" title="type std::os::raw::c_uint">c_uint</a><br>) -&gt; <a class="type" href="../flac_sys/type.FLAC__bool.html" title="type flac_sys::FLAC__bool">FLAC__bool</a></pre><div class='docblock'><p>Set the metadata blocks to be emitted to the stream before encoding.
A value of \c NULL, \c 0 implies no metadata; otherwise, supply an
array of pointers to metadata blocks.  The array is non-const since
the encoder may need to change the \a is_last flag inside them, and
in some cases update seek point offsets.  Otherwise, the encoder will
not modify or free the blocks.  It is up to the caller to free the
metadata blocks after encoding finishes.</p>
<p>\note
The encoder stores only copies of the pointers in the \a metadata array;
the metadata blocks themselves must survive at least until after
FLAC__stream_encoder_finish() returns.  Do not free the blocks until then.</p>
<p>\note
The STREAMINFO block is always written and no STREAMINFO block may
occur in the supplied array.</p>
<p>\note
By default the encoder does not create a SEEKTABLE.  If one is supplied
in the \a metadata array, but the client has specified that it does not
support seeking, then the SEEKTABLE will be written verbatim.  However
by itself this is not very useful as the client will not know the stream
offsets for the seekpoints ahead of time.  In order to get a proper
seektable the client must support seeking.  See next note.</p>
<p>\note
SEEKTABLE blocks are handled specially.  Since you will not know
the values for the seek point stream offsets, you should pass in
a SEEKTABLE 'template', that is, a SEEKTABLE object with the
required sample numbers (or placeholder points), with \c 0 for the
\a frame_samples and \a stream_offset fields for each point.  If the
client has specified that it supports seeking by providing a seek
callback to FLAC__stream_encoder_init_stream() or both seek AND read
callback to FLAC__stream_encoder_init_ogg_stream() (or by using
FLAC__stream_encoder_init*_file() or FLAC__stream_encoder_init*<em>FILE()),
then while it is encoding the encoder will fill the stream offsets in
for you and when encoding is finished, it will seek back and write the
real values into the SEEKTABLE block in the stream.  There are helper
routines for manipulating seektable template blocks; see metadata.h:
FLAC__metadata_object_seektable_template</em>*().  If the client does
not support seeking, the SEEKTABLE will have inaccurate offsets which
will slow down or remove the ability to seek in the FLAC stream.</p>
<p>\note
The encoder instance \b will modify the first \c SEEKTABLE block
as it transforms the template to a valid seektable while encoding,
but it is still up to the caller to free all metadata blocks after
encoding.</p>
<p>\note
A VORBIS_COMMENT block may be supplied.  The vendor string in it
will be ignored.  libFLAC will use it's own vendor string. libFLAC
will not modify the passed-in VORBIS_COMMENT's vendor string, it
will simply write it's own into the stream.  If no VORBIS_COMMENT
block is present in the \a metadata array, libFLAC will write an
empty one, containing only the vendor string.</p>
<p>\note The Ogg FLAC mapping requires that the VORBIS_COMMENT block be
the second metadata block of the stream.  The encoder already supplies
the STREAMINFO block automatically.  If \a metadata does not contain a
VORBIS_COMMENT block, the encoder will supply that too.  Otherwise, if
\a metadata does contain a VORBIS_COMMENT block and it is not the
first, the init function will reorder \a metadata by moving the
VORBIS_COMMENT block to the front; the relative ordering of the other
blocks will remain as they were.</p>
<p>\note The Ogg FLAC mapping limits the number of metadata blocks per
stream to \c 65535.  If \a num_blocks exceeds this the function will
return \c false.</p>
<p>\default \c NULL, 0
\param  encoder     An encoder instance to set.
\param  metadata    See above.
\param  num_blocks  See above.
\assert
\code encoder != NULL \endcode
\retval FLAC__bool
\c false if the encoder is already initialized, else \c true.
\c false if the encoder is already initialized, or if
\a num_blocks &gt; 65535 if encoding to Ogg FLAC, else \c true.</p>
</div></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../";window.currentCrate = "flac_sys";</script><script src="../aliases.js"></script><script src="../main.js"></script><script defer src="../search-index.js"></script></body></html>